# Riff 애플리케이션 하루 및 주간 일정 렌더링/배치 규칙

이 문서는 Riff 캘린더 화면(특히 `WeekCard` 컴포넌트)에서 일정이 시간, 종일 여부, 다중 일자 여부 등 조건에 따라 하루나 주간 칸 내의 어느 위치에 어떻게 배치되는지 그 규칙을 정리한 문서입니다.

## 1. 다중 일자 종일 일정 (Multi-day All-Day Events)
하루를 초과하여 이틀 이상 걸쳐 있는 종일 일정 또는 특정 시간을 가지지 않는 장기 일정입니다.
- **배치 위치:** 날짜별 셀(AM/PM)에 갇히지 않고, 캘린더 요일 헤더 바로 아래(Row 2 영역)에서 주간 단위로 가로 전체 길이를 사용해 독립적(`allDayRow`)으로 그려집니다.
- **렌더링 방식:** 여러 날짜에 걸친 바(Bar) 모양으로 연속되게 표시되며, 층(level) 충돌을 피하기 위해 `useAllDayEventLayout` 훅을 통해 위아래 쌓이는 위치가 자동 계산됩니다.

## 2. 단일 일자 종일 일정 (Single-day All-Day Events)
다중 일자가 아니며(특정 하루에만 속함) 시간(`startTime`)이 지정되지 않은 일정입니다.
- **배치 영역:** 오전 영역(`amEvents` 셀) 안에 배치됩니다.
- **위치 규칙:** 오전 일정들 중에서도 가장 **상단(Top)**에 그룹을 지어 우선 배치됩니다(`justify-content: flex-start`).
- **표시:** 시간이 없으므로 타이틀 위주로 컴팩트(compact)하게 렌더링됩니다.

## 3. 오전 일정 (AM Events)
시작 時間(`startTime`)이 낮 12시 이전(00:00 ~ 11:59)인 모든 일정을 의미합니다. 
- **배치 영역:** 해당 날짜의 평시 오전 영역(`amEvents` 셀)에 배치됩니다. (단일 종일 일정 바로 아래 공간)
- **정렬 기준:** 시작 시간(`startTime`) 기준 **오름차순**으로 정렬됩니다.
- **수직 정렬 위치 동적 변화 (중요 규칙):**
  - **해당 주(Week)에** 오전 12시를 가로지르는 **오전-오후 걸침 일정(Spanning Event)**이 하루라도 존재한다면: 시각적 일관성을 맞추기 위해 **해당 주의 '모든 날짜' 오전 일정 컨테이너**가 12시 구분선과 가까워지도록 셀 **하단(Bottom)으로 밀착**(`justify-content: flex-end`)합니다.
  - 해당 주에 걸쳐 있는 일정이 하나도 없다면: 셀의 **상단(Top)으로 밀착**하여 단일 종일 일정 바로 밑에서부터 시작합니다.

## 4. 오전과 오후에 걸친 일정 (Spanning Events)
시작 시간이 12:00보다 이전이면서(`startTime < '12:00'`), 종료 시간이 12:00보다 이후(`endTime > '12:00'`)인 **정오 구분선을 넘어가는 일정**입니다. 
걸친 일정의 연속성을 시각적으로 표현하기 위해, 하나의 일정이 오전 구역과 오후 구역에 나뉘어 **중복 렌더링**됩니다.

* **AM 셀(오전 구역) 렌더링 제어 규칙:** 
  - 오전 일정 규칙에 따라 함께 정렬/배치됩니다. (앞서 설명한 '오전 리스트 하단 밀착'을 유발하는 원인입니다.)
  - 시작 시간과 종료 시간 중 **오전 파트에 속하는 선행 시간(Start-time)만 부분 표시**됩니다 (`timeDisplay = 'start-only'`).
* **PM 셀(오후 구역) 렌더링 제어 규칙:** 
  - 오후 일정들 중에서 언제나 가장 최우선적으로 12시 구분선 바로 아래(오후 영역 **가장 상단**)에 별도 그룹(`spanningPmEvents`)으로 분리되어 밀착 배치됩니다. 
  - **오후 파트에 속하는 후행 시간(End-time)만 부분 표시**됩니다 (`timeDisplay = 'end-only'`).
  - 오전 영역에 이미 동일한 이벤트의 삭제 버튼이 노출되므로, 시각적 중복을 피하기 위해 오브젝트 마우스 오버 시 뜨는 **삭제 버튼이 숨김(Hide)** 처리됩니다.

## 5. 평시 오후 일정 (Normal PM Events)
시작 시간이 12:00 이후이거나 같은(`startTime >= '12:00'`) 일정입니다.
- **배치 영역:** 정오 구분선 아래 오후 영역(`pmEvents` 셀)에 표기됩니다.
- **배치 순서:** (있을 경우) 걸친 일정(Spanning Event) 블록 아래쪽에 나열됩니다. 컨테이너 자체는 셀의 가장 위에서 아래로 쌓이게 됩니다.
- **정렬 기준:** 일반적인 시작 시간 기준이 아니라, **종료 시간(End-time) 기준 오름차순**으로 정렬되는 것이 특징입니다. (단, 종료 시간이 없는 경우 시작 시간을 폴백(fallback)으로 참조)

## 6. 기타 표시 규칙: 12시 구분선 (Divider Line)
- 이번 주에 렌더링될 데이터(오전, 오후 등 모든 단일 이벤트 포함)가 단 하나라도 존재하여 카드상에 표출되고 있다면, AM 블록과 PM 블록 사이에 **"오후"**라는 텍스트 라벨이 박힌 가로 점선 레이아웃(Row 3)이 삽입됩니다. 
- 이 점선을 통해 상단의 오전/종일 영역, 하단의 오후를 직관적으로 상하 분리합니다. 
